grid.arrange(p_self, p_obj, ncol = 2)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
x <- rnorm(n)
y <- x + 2*rnorm(n)
data = cbind(x,y)
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
perc_self = 100 * sapply(split_obj, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_obj, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
corr(x,y)
cor(x,y)
x <- rnorm(n)
y <- x + 4*rnorm(n)
cor(x,y)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
x <- rnorm(n)
y <- x + 4*rnorm(n)
cor(x,y)
data = cbind(x,y)
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
perc_self = 100 * sapply(split_obj, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_obj, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
x <- rnorm(n)
y <- x + 4*rnorm(n)
cor(x,y)
n <- 1000
data = matrix(0.0, nrow=n, ncol=2)
data[,1] = rnorm(n)
data[,2] = data[,1] + 0.5*rnorm(n)
colnames(data) <- c("self","obj")
data = cbind(x,y)
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
perc_self = 100 * sapply(split_obj, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_obj, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
cor(data[,1],data[,2])
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
x <- rnorm(n)
y <- x + 4*rnorm(n)
cor(x,y)
data = cbind(x,y)
n <- 1000
data = matrix(0.0, nrow=n, ncol=2)
data[,1] = rnorm(n)
data[,2] = data[,1] + 4*rnorm(n)
colnames(data) <- c("self","obj")
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
perc_self = 100 * sapply(split_obj, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_obj, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
cor(data[,1],data[,2])
n <- 1000
data = matrix(0.0, nrow=n, ncol=2)
data[,1] = rnorm(n)
data[,2] = data[,1] + 0.5*rnorm(n)
colnames(data) <- c("self","obj")
cor(data[,1],data[,2])
cor(data[,1],data[,2])
n <- 1000
data = matrix(0.0, nrow=n, ncol=2)
data[,1] = rnorm(n)
data[,2] = data[,1] + 4*rnorm(n)
colnames(data) <- c("self","obj")
cor(data[,1],data[,2])
pnorm(5)
1-pnorm(5)
1-pnorm(6)
1-pnorm(7)
1-pnorm(9)
1-pnorm(7.5)
1-pnorm(7.7)
1-pnorm(7.75)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
#n <- 1000
#data = matrix(0.0, nrow=n, ncol=2)
#data[,1] = rnorm(n)
#data[,2] = data[,1] + 4*rnorm(n)
#colnames(data) <- c("self","obj")
#cor(data[,1],data[,2])
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
#df_obj <- data.frame(
#  group = factor(names(split_obj), levels = 1:4),
#  perc_self = 100 * sapply(split_obj, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
#  perc_obj = 100 * sapply(split_obj, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
#)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
mean_self = sapply(split_obj, function(x) mean(x[,"self"])),
mean_obj = sapply(split_obj, function(x) mean(x[,"obj"]))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
pnorm(6)
1-pnorm(6)
1-pnorm(7.5)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
#n <- 1000
#data = matrix(0.0, nrow=n, ncol=2)
#data[,1] = rnorm(n)
#data[,2] = data[,1] + 4*rnorm(n)
#colnames(data) <- c("self","obj")
#cor(data[,1],data[,2])
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
mean_self = sapply(split_obj, function(x) mean(x[,"self"])),
mean_obj = sapply(split_obj, function(x) mean(x[,"obj"]))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
#n <- 1000
#data = matrix(0.0, nrow=n, ncol=2)
#data[,1] = rnorm(n)
#data[,2] = data[,1] + 4*rnorm(n)
#colnames(data) <- c("self","obj")
#cor(data[,1],data[,2])
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
mean_self = sapply(split_obj, function(x) mean(x[,"self"])),
mean_obj = sapply(split_obj, function(x) mean(x[,"obj"]))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
mean_self = sapply(split_obj, function(x) mean(x[,"self"])),
mean_obj = sapply(split_obj, function(x) mean(x[,"obj"]))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(564)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
#n <- 1000
#data = matrix(0.0, nrow=n, ncol=2)
#data[,1] = rnorm(n)
#data[,2] = data[,1] + 4*rnorm(n)
#colnames(data) <- c("self","obj")
#cor(data[,1],data[,2])
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
perc_self = 100 * sapply(split_obj, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_obj, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
library(MASS)
library(ggplot2)
library(gridExtra)
n <- 1000
mu <- c(0, 0)
rho <- 0.19
sigma <- matrix(c(1, rho, rho, 1), nrow = 2)
set.seed(565)
data <- mvrnorm(n = n, mu = mu, Sigma = sigma)
#n <- 1000
#data = matrix(0.0, nrow=n, ncol=2)
#data[,1] = rnorm(n)
#data[,2] = data[,1] + 4*rnorm(n)
#colnames(data) <- c("self","obj")
#cor(data[,1],data[,2])
colnames(data) <- c("self","obj")
# Quartiles based on first column (self)
q_self <- quantile(data[,1], probs = c(0.25, 0.5, 0.75))
groups_self <- cut(data[,1], breaks = c(-Inf, q_self[1], q_self[2], q_self[3], Inf), labels = FALSE)
split_self <- split(as.data.frame(data), groups_self)
df_self <- data.frame(
group = factor(names(split_self), levels = 1:4),
perc_self = 100 * sapply(split_self, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_self, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_self <- ggplot(df_self, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (self-report)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
# Quartiles based on second column (obj)
q_obj <- quantile(data[,2], probs = c(0.25, 0.5, 0.75))
groups_obj <- cut(data[,2], breaks = c(-Inf, q_obj[1], q_obj[2], q_obj[3], Inf), labels = FALSE)
split_obj <- split(as.data.frame(data), groups_obj)
df_obj <- data.frame(
group = factor(names(split_obj), levels = 1:4),
perc_self = 100 * sapply(split_obj, function(x) ecdf(data[,"self"])(mean(x[,"self"]))),
perc_obj = 100 * sapply(split_obj, function(x) ecdf(data[,"obj"])(mean(x[,"obj"])))
)
p_obj <- ggplot(df_obj, aes(x = group)) +
geom_line(aes(y = perc_obj, group = 1, color = "Objective")) +
geom_point(aes(y = perc_obj, color = "Objective")) +
geom_line(aes(y = perc_self, group = 1, color = "Self-report")) +
geom_point(aes(y = perc_self, color = "Self-report")) +
labs(x = "Group (objective)", y = "Percentile (%)", color = "") +
theme(legend.position = "bottom")
grid.arrange(p_self, p_obj, ncol = 2)
